from rest_assured.testcases import ReadWriteRESTAPITestCaseMixin, BaseRESTAPITestCase
from VMA import factories
import datetime


class VulnAPITestCase(ReadWriteRESTAPITestCaseMixin, BaseRESTAPITestCase):
    base_name = 'rest_framework:vulnerability'
    factory_class = factories.VulnFactory
    user_factory = factories.UserFactory
    response_lookup_field = 'vulnID'
    attributes_to_check = ['vulnID']
    update_data = {'actionPlan': 'updated',
                   'scanType': 'M', }

    def get_create_data(self):
        data = {'name': 'TestVuln',
                   'description': 'Desc',
                   'severity': 0,
                   'dateDiscovered': '1985-1-1',
                   'dateModified': datetime.datetime.now(),
                   'actionPlan': 'git gud',
                   'solution': '',
                   'assetID': factories.AssetFactory.create().pk,
                   'status': 'U',
                   'scanType': 'Z',
                   'reference': 'i dunno',
                   'cvssScore': 0, }
        return data
